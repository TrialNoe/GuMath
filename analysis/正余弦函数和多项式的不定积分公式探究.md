---
tags:
  - "#math"
  - math_calculus
---
我们在算很多地方都见到这种$\int x\sin x\,dx$，$\int x^{ 2 }\cos x\,dx$，每次都用[[Integration by Parts]]算的太累了，所以看看有没有什么简便的方法来做这个问题。
对这个结构进行分析一下：
积分符号$\int$，幂函数（多项式函数可以通过逐项积分分成很多个幂函数嘛）$x,x^{ 2 }\dots x^{ n }$感觉这里要用**数学归纳法**，正余弦函数$\sin x,\cos x$
学到一个新技能[The Tabular Method: A Shortcut for Integration By Parts (Calculus 2)](https://www.youtube.com/watch?v=yQruNWGjDyE&t=66s)

先做简单的开始
对于$\int x^{ n }\sin x \, dx$,$n \in N$
## n=1

> [!example]
> $$
> \int x\sin x\,dx
> $$

| Signs | $u$ | $dv$      |
| ----- | --- | --------- |
| +     | $x$ | $\sin x$  |
| -     | $1$ | $-\cos x$ |
| +     | $0$ | $-\sin x$ |
$$
Given =  x\cos x -\sin x+ C
$$
## n=2

> [!example]
> $$
> \int x^{ 2 }\sin x\,dx
> $$


| Signs | $u$       | $dv$      |
| ----- | --------- | --------- |
| +     | $x^{ 2 }$ | $\sin x$  |
| -     | $2x$      | $\cos x$  |
| +     | $2$       | $-\sin x$ |
| -     | $0$       | $-\cos x$ |
$$
Given = x^{ 2 }\cos x-2x\cos x-2\cos x +C
$$
## n=3
> [!example]
> $$
> \int x^{ 3 }\sin x\,dx
> $$

| Signs | $u$        | $dv$      | $dv$                                           |
| ----- | ---------- | --------- | ---------------------------------------------- |
| +     | $x^{ 3 }$  | $\sin x$  | $\sin x$                                       |
| -     | $3x^{ 2 }$ | $\cos x$  | $\sin  \left( x + 1\cdot\frac{\pi}{2} \right)$ |
| +     | $6x$       | $-\sin x$ | $\sin \left( x+2\cdot\frac{\pi}{2} \right)$    |
| -     | $6$        | $-\cos x$ | $\sin \left( x+3\cdot\frac{\pi}{2} \right)$    |
| +     | 0          | $\sin x$  | $\sin \left( x+4\cdot\frac{\pi}{2} \right)$    |

$$
Given = x^{ 3 }\cos x + 3x^{ 2 }\sin x -6x\cos x +6\cos x +C
$$



根据[[基于三角函数对称性的积分恒等式]]我们知道$\sin x$和$\cos x$之间可以通过$\frac{\pi}{2}$进行转换
我们魔改一下这个表格

| Signs | $u$        | $dv$      | $dv$                                           |
| ----- | ---------- | --------- | ---------------------------------------------- |
| +     | $x^{ 3 }$  | $\sin x$  | $\sin x$                                       |
| -     | $3x^{ 2 }$ | $\cos x$  | $\sin  \left( x + 1\cdot\frac{\pi}{2} \right)$ |
| +     | $6x$       | $-\sin x$ | $\sin \left( x+2\cdot\frac{\pi}{2} \right)$    |
| -     | $6$        | $-\cos x$ | $\sin \left( x+3\cdot\frac{\pi}{2} \right)$    |
| +     | 0          | $\sin x$  | $\sin \left( x+4\cdot\frac{\pi}{2} \right)$    |
初始有$n=1$的时候有三列表格,$n=2$的时候有四列表格所以说是不是$n=k$的时候有$k+2$列表格呢
我们猜想这个通式，就是这个n有点难猜，第一项实在是放不进去就单拿出来吧
$$
\int x^{ n }\sin x \, dx = \sum_{r=0}^{ n }\frac{ (-1)^{ r }\cdot n!}{(n-r)!} x^{ n-r }  \sin\left[ x+ (r+1) \cdot \frac{\pi}{2} \right] +C
$$


## n=k
我们假设$n=k-1$成立，那么
$$
\int x^{ k-1 }\sin x \, dx = \sum_{r=0}^{ k-1 }\frac{ (-1)^{ r }\cdot (k-1)!}{(k-1-r)!} x^{ k-1-r }  \sin\left[ x+ (r+1) \cdot \frac{\pi}{2} \right] +C
$$
这样前k项已经搞定了，我们只要来算$k+1$项

| ID       | Signs          | u                           | dv                                                |
| -------- | -------------- | --------------------------- | ------------------------------------------------- |
| $\vdots$ | $\vdots$       | $\vdots$                    | $\vdots$                                          |
| $k-1$    | $(-1)^{ k-1 }$ | $\frac{k!}{(k-k-1)!} = k!x$ | $\sin \left[ x + (k-1)\cdot\frac{\pi}{2} \right]$ |
| $k$      | $(-1)^{ k}$    | $k!$                        | $\sin \left[ x +k\cdot\frac{\pi}{2} \right]$      |
|          |                | $0$                         | $\sin \left[ x + (k+1)\cdot\frac{\pi}{2} \right]$ |

$$
\begin{aligned}
\int x^{ k }\sin x \, dx 
&= \sum_{r=0}^{ k-1 }\frac{ (-1)^{ r }\cdot (k-1)!}{(k-1-r)!} x^{ k-1-r }  \sin\left[ x+ (r+1) \cdot \frac{\pi}{2} \right]  + (-1)^{ k }k!\cdot \sin \left[ x + (k+1)\cdot\frac{\pi}{2} \right]\\
&=\sum_{r=0}^{ k }\frac{ (-1)^{ r }\cdot k!}{(k-r)!} x^{ k-r }  \sin\left[ x+ (r+1) \cdot \frac{\pi}{2} \right] +C
\end{aligned}

$$


![[正余弦函数和多项式的不定积分公式探究_项合并注解.png]]

这个破公式难记，还是记有规律的表格好
有个问题是不是说很多这种连加都能写成表格？？


















